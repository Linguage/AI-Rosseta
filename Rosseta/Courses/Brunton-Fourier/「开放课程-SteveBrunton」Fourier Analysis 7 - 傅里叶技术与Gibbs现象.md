
> - 视频链接：[Fourier Series & Gibbs Phenomena [Matlab]](https://www.youtube.com/watch?v=98VixA3MjAc&list=PLMrJAkhIeNNT_Xh3Oy0Y4LTj0Oxo8GqsC&index=8)
> - 作者：[Steve Brunton](https://www.youtube.com/@Eigensteve)
> - 本内容整理自视频脚本，仅供参考。请观看原视频及相关资料。此外，作者还提供了Python版本的实现，点击[Python版视频链接](https://youtu.be/sSvj1nCC6_o?si=O2M2JEddzBKQ_AE2)
> - 程序可从网站：[https://databookuw.com/](https://databookuw.com/) 下载，


##  内容简介

本讲座内容主要探讨了傅里叶级数在函数逼近中的应用，特别关注了当目标函数包含不连续点时出现的一个重要现象——吉布斯现象。讲座首先简要回顾了傅里叶级数的计算方法，并将其应用于一个具有明显跳跃的不连续函数（方波函数或称“Top-Hat”函数）的逼近问题上，整个过程通过 MATLAB 代码进行了演示。

核心部分详细介绍并解释了吉布斯现象：即在不连续点附近，由有限项傅里叶级数逼近所产生的 характерный (characteristic) 的过冲和振荡。讲座阐述了该现象产生的原因，在于使用光滑的正弦和余弦基函数去拟合尖锐的不连续性时，截断（只使用有限项）所带来的必然结果。此外，讲座还讨论了增加傅里叶级数项数对逼近效果及吉布斯现象的影响，并通过动画直观展示了随着项数增多，振铃如何变得更加局部化。特别指出了在离散计算中使用特定项数（如N/2）时可能产生的误导性结果。

最后，简要提及了吉布斯现象在更广泛的数值计算领域（如近似导数和求解偏微分方程）中的相关性。如果您对傅里叶分析的实际应用及其在处理非光滑信号时的局限性感兴趣，这份详细的讲座实录将为您提供深入的理解和具体的实例。

## 内容纲要

```
Fourier Series & Gibbs Phenomena [Matlab]
├── 引言与背景
│   ├── 回顾傅里叶级数计算 (Matlab/Python)
│   └── 本次焦点：不连续函数与潜在问题
│       └── 对比：连续三角波 vs. 不连续方波
├── 示例设置：方波函数 (Top-Hat Function)
│   ├── 目标函数描述 (跳跃不连续)
│   └── Matlab 实现细节
│       ├── 定义域 [0, 10]
│       ├── 离散点数 N=1024
│       └── 函数构造 (中间段为1，其余为0)
├── 傅里叶级数逼近计算
│   ├── 计算方法：傅里叶系数 a_k, b_k
│   │   ├── 基于内积 (函数向量与基向量点积)
│   │   └── 数值实现 (离散求和, 归一化)
│   ├── 逼近项数：前 100 项
│   └── 可视化：原始函数 vs. 逼近结果
├── 吉布斯现象 (Gibbs Phenomenon)
│   ├── 现象观察：不连续点附近的“振铃”/过冲
│   ├── 现象定义与重要性
│   └── 现象解释
│       ├── 基函数的光滑性 (sin/cos)
│       ├── 不连续性的精确构建需要无限项
│       └── 截断效应导致能量无法完全抵消
├── 增加傅里叶级数项数的影响
│   ├── 理论极限：无限项 → 现象消失
│   ├── 实际情况：有限项截断 → 现象存在
│   └── 特殊情况 (N/2 项)
│       ├── 在离散点上表现良好 (与 DFT/FFT 相关)
│       ├── **重要警示**：更高分辨率下振铃依然存在 (采样点误导)
├── 吉布斯现象的可视化演变
│   ├── 动画演示 (M=1 到 100 项)
│   └── 观察结论
│       ├── 平坦区逼近改善
│       └── 振铃更窄、更集中于不连续点
└── 与导数计算的潜在联系
    ├── 示例：三角波导数 → 方波
    └── 应用：在导数逼近中也可能出现吉布斯现象 (如 PDE 求解)
```



# 傅里叶级数与吉布斯现象 [Matlab]

### 一、 引言与背景

欢迎回来。我们一直在讨论傅里叶级数。在之前的几个视频中，我向大家展示了如何在 Matlab 和 Python 中计算这些级数。现在，我要向大家展示的是，当你在不连续函数上使用傅里叶级数时，可能会出现什么问题。

在之前的视频中，我们逼近了一个三角帽函数（Triangular Hat Function）。那个函数虽然不是光滑的，也就是说它有尖角，但它是连续的，函数值没有发生跳跃。而现在，我们要处理的是一个方波函数（Top Hat Function），这个函数在其定义域内有两处会发生跳跃的不连续点。具体来说，这个函数先是保持一个常数值，然后突然跳跃到另一个常数值，维持一段后，再跳回到原来的值，比如跳回到零。

### 二、 示例设置：方波函数

我们将再次使用 MATLAB 来编程实现这个过程，这其实非常简单。我们会设定一个定义域，比如从 $0$ 到 $10$。实际上，定义域具体是什么并不太重要，这里我们就选用 $0$ 到 $10$。我想，我选择在这个区间内生成了 $1024$ 个离散点，这是一个不错的数字，方便计算，比如能被 4 整除。

定义这个函数 $f(x)$ 的方式也很直接：首先，将函数在所有 $1024$ 个点上的值都初始化为零。然后，选取中间的一部分点，比如说定义域中间的一半区间（例如 $x$ 从 $2.5$ 到 $7.5$），将这些点上的函数值设为 $1$。这样我们就构造了一个离散的方波函数向量。

### 三、 傅里叶级数逼近计算

接下来，我们的目标是计算这个方波函数的傅里叶级数逼近。这次，我们将计算级数的前 $100$ 项，注意，是 $100$ 项，而不是之前例子中使用的 $20$ 项。

让我再次提醒大家计算傅里叶系数 $a_k$ 和 $b_k$ 的方法。我们是通过取函数 $f(x)$ 与相应的基函数——也就是 $\cos(kx)$ 模式和 $\sin(kx)$ 模式——进行内积（Inner Product）来计算的。因为我们是在计算机上进行数值计算，所以这里的函数 $f(x)$ 实际上是一个包含了它在 $0$ 到 $10$ 这个区间上那 $1024$ 个离散点处函数值的向量。同样，$\cos(kx)$ 和 $\sin(kx)$ 也是在这些点上取值的向量。

因此，计算内积实际上就是在计算向量的点积（Dot Product）。具体来说，就是将函数向量 $f$ 与 $\cos$ 向量或 $\sin$ 向量进行对应元素相乘后求和。这就是点积的计算过程。此外，我们还需要进行归一化处理。根据傅里叶级数的定义，我们需要乘以一个因子 $2/L$（其中 $L$ 是区间的总长度，这里是 $10$），并且还要考虑到我们是用离散求和来近似积分的，所以需要乘以步长 $\Delta x$。

一旦我们计算出前 $100$ 项对应的 $a_k$ 和 $b_k$ 系数，并将这些项 $a_k \cos(kx) + b_k \sin(kx)$ 加起来，我们就得到了傅里叶级数的逼近函数。最后，我会将原始的方波函数（白色表示）和它的 $100$ 项傅里叶级数逼近结果（红色表示）绘制在同一张图上。整个代码实现起来是相当简单的。

### 四、 吉布斯现象 (Gibbs Phenomenon)

这就是我们得到的计算结果。你可以看到，这个逼近结果在整体形态上（qualitatively）大致是正确的。白色的方波函数是我们想要逼近的目标函数，而红色的曲线是我们计算得到的包含 $100$ 个模式（项）的傅里叶级数逼近。

仔细观察可以发现，这个逼近函数确实抓住了方波的大致行为特征。但是，在方波函数发生跳跃的不连续点（即那些“角落”处）附近，出现了一种非常有趣的现象：函数图像产生了明显的“振铃”（ringing）或者说“过冲”（overshoot）。这种现象被称为“吉布斯现象”（Gibbs Phenomenon）。

吉布斯现象非常、非常重要，你在很多领域都会遇到它。它本质上告诉我们：当处理一个含有不连续点的函数时，只要你使用有限项（即截断的）傅里叶级数去逼近它，那么在这些不连续点的附近，就几乎不可避免地会出现这种振荡性的伪影（artifacts）。

当然，理论上，如果你能够加总无限多项正弦和余弦函数，也就是说，当这里的 $100$ 项趋向于无穷时，在极限情况下，吉布斯现象是会消失的，级数会收敛到函数在不连续点处的左右极限的平均值。但是，在任何实际应用中，我们都只能使用有限项。因此，只要你对方波这类不连续函数的傅里叶级数进行截断，你就会观察到这种振铃状的吉布斯现象。

为什么会这样呢？原因在于傅里叶级数的基础函数——正弦和余弦函数——本身都是无限光滑（smooth）的函数，它们自身没有任何不连续性。要想精确地构建出函数图像中那种垂直的、无限陡峭的跳变（不连续点），唯一的方法就是将无穷多个、具有不同频率的正弦和余弦函数，按照极其精确的比例叠加起来。只有这样，它们才能在除了跳变点之外的地方完美地相互抵消，而在跳变点处精确地叠加形成那个“悬崖”。

如果我们只取了有限项，比如前 $100$ 项，那么那些被我们舍弃掉的高频项（它们对于形成尖锐边缘至关重要）就缺失了。结果就是，在不连续点附近，这些有限项的正弦和余弦函数无法完美地“协作”来形成陡峭的边缘，从而导致了这种能量“泄漏”般的振荡。

所以，这就是吉布斯现象。你在进行数值模拟和计算（numerics）时会经常碰到它。现在你了解了它的存在，以后在处理数据或进行模拟时，如果看到结果中出现类似的振铃，就应该能意识到，这很可能是因为你正在用截断的傅里叶级数（或其他类似的基于光滑基函数的展开）来逼近一个不连续的现象或函数。

### 五、 增加傅里叶级数项数的影响

关于傅里叶级数的项数，有一点值得注意。你会看到，如果把逼近所用的项数从 $1$ 项增加到 $100$ 项，甚至进一步增加，比如说增加到 $N/2$ 项——这里的 $N$ 是我们离散化时使用的网格点数，在这个例子里 $N=1024$——那么如果我们使用 $N/2 = 512$ 项来逼近呢？

在这种情况下 ($M=N/2$)，你会发现在我们选取的这 $N$ 个离散采样点上，逼近效果看起来非常好，几乎完美地重合了！似乎吉布斯现象消失了。所以，当你在一个具有 $N$ 个点的离散域上逼近函数时，使用 $N/2$ 个正弦和余弦模式（这对应于离散傅里叶变换能表示的最高频率成分）确实可以在这些离散点上得到一个非常好的近似结果。这种 $N/2$ 的关系与离散傅里叶变换（DFT）和快速傅里叶变换（FFT）密切相关。FFT正是在离散数据向量上高效计算这些傅里叶系数的方法，我们之后会更详细地讨论它。

但我想强调的是，这里有一个重要的陷阱（rub）！虽然在 $N=1024$ 个离散点上，使用 $N/2=512$ 个模式得到的逼近看起来很好，但这具有误导性。如果我们提高原始函数的分辨率，比如在原来的点之间插入更多的点（或者说用更高分辨率的网格重新采样函数），然后再用这 $512$ 项的级数去计算这些新点上的值，你会发现，这个逼近函数实际上存在着非常剧烈的振铃！

之所以在原来的 $1024$ 个点上看不出来，是因为这些采样点恰好“幸运地”避开了振铃的峰值和谷值，它们正好落在了振荡波形的某些特定位置上，使得看起来像是完美拟合了。但如果你考察这些采样点之间的区域，比如将分辨率加倍，你就会清楚地看到，这个函数仍然在不连续点附近剧烈地振荡。

所以，吉布斯现象是一个你必须警惕的、相当“危险”的现象。它并不会因为你恰好选取了 $N/2$ 项而在连续意义上消失，只是可能在特定的离散采样点上被掩盖了。

### 六、 吉布斯现象的可视化演变

也许我应该回放一下刚才的图像，让你更清楚地看到吉布斯现象的样子…… 我觉得，把这个逼近过程制作成一个动画会很有趣。

现在我们来做这样一个演示：我们将绘制傅里叶级数逼近的结果，让逼近的项数 $M$ 从 $1$ 逐渐增加到 $100$。我们将观察随着阶数 $M$ 的增加，吉布斯现象是如何演变的——是变得更严重，还是有其他变化。这是一个很酷的动画，你可以在我们的配套书籍网站（databookuw.com）上找到并下载它。

通过这个动画，你可以看到吉布斯现象随着逼近阶数（项数 $M$）的增加，其行为是如何变化的。初始时，比如只用第一项（$M=1$），逼近结果只是在方波中间的一个大致的凸起。然后，随着你不断加入更高频率的模式（增加 $M$），这些模式会相互作用、相互抵消，使得函数在顶部平坦区域的逼近越来越好，越来越平。

然而，与此同时，这种改进是以振铃现象被更加“压缩”和“集中”到不连续点（角落）附近为代价的。也就是说，振荡的幅度（过冲量相对于跳变高度的比例）并不会随着项数增加而减小（它会趋于一个常数，大约是跳变高度的 9%），但是振荡发生的区域会越来越窄，越来越贴近不连续点。

### 七、 与导数计算的潜在联系

这是一个非常重要的性质。有趣的是，你会在其他地方也看到吉布斯现象的应用或影响。我稍后会给出一个具体的例子。还记得吗？我们可以对之前那个连续的三角帽函数进行傅里叶变换。现在考虑对这个三角帽函数求导数。它的导数是什么样的呢？恰好就是一个方波函数（或者类似的分段常数函数）！

那么，如果我使用傅里叶变换（或者说傅里叶级数的方法）来近似计算这个三角帽函数的导数，由于其真实的导数是一个不连续的方波函数，那么我在计算得到的导数逼近结果中，就会不可避免地出现吉布斯现象！

所以，这一点很重要，尤其是在我们后续讨论使用傅里叶变换来求解偏微分方程（PDEs）的时候。因为PDEs经常涉及到导数计算，如果解本身或其导数存在不连续性，而我们又用了基于傅里叶谱方法（Spectral Methods）去求解，那么就要警惕吉布斯现象的出现。我之后在讲解相关内容时会再向大家展示这一点。

好的，谢谢大家。

---

# 要点回顾

**视频主题：傅里叶级数与吉布斯现象（Matlab 实现）**

**一、 引言与背景**
- 回顾之前关于傅里叶级数计算的内容（已在 Matlab 和 Python 中演示）。
- 本次视频焦点：当傅里叶级数应用于不连续函数时可能出现的问题（吉布斯现象）。
- 对比：之前处理的是连续但不可微的三角波函数，现在处理的是具有跳跃不连续点的方波函数（Top Hat Function）。

**二、 示例设置：方波函数**
- 目标函数：一个方波函数，在定义域内从一个常数值跳跃到另一个常数值，再跳回。
- Matlab 实现细节：
    - 定义域：$[0, 10]$。
    - 离散点数：$N=1024$。
    - 函数定义：先全部设为0，然后将中间一半（例如 $x \in [2.5, 7.5]$）设为1。

**三、 傅里叶级数逼近计算**
- 计算方法：
    - 计算傅里叶系数 $a_k$ 和 $b_k$。
    - 方法：通过函数 $f(x)$（表示为离散数据向量）与对应的 $\cos(kx)$ 和 $\sin(kx)$ 模式（也是离散向量）的内积（点积）来计算。
    - 数值内积近似：`sum(f * mode_vector) * dx`，并进行归一化（乘以 $2/L$，其中 $L$ 是区间长度）。
- 逼近项数：使用傅里叶级数的前 100 项进行逼近。
- 可视化：绘制原始方波函数和其 100 项傅里叶级数逼近结果。

**四、 吉布斯现象 (Gibbs Phenomenon)**
- 观察结果：在方波函数的不连续点（跳跃处）附近，傅里叶级数逼近（红色曲线）出现明显的“振铃”（ringing）或过冲（overshoot）现象。
- 定义：这种在不连续点附近由截断傅里叶级数引起的振荡伪影被称为吉布斯现象。
- 现象解释：
    - 基础函数：正弦和余弦函数是光滑（无限可微）的。
    - 不连续性构建：要精确构建一个尖锐的不连续跳变，理论上需要无限多项、具有特定比例关系的正弦和余弦函数叠加，才能完美相消形成陡峭边缘。
    - 截断效应：当只使用有限项（例如 100 项）进行逼近时，高频项的缺失导致在不连续点附近无法完全抵消，从而产生振荡。
- 重要性：吉布斯现象在数值计算和信号处理中非常重要且常见，尤其是在使用基于傅里叶的方法处理含不连续性的问题时。

**五、 增加傅里叶级数项数的影响**
- 理论极限：如果使用无限多项傅里叶级数，吉布斯现象将会消失（级数收敛到函数在不连续点处的左右极限平均值）。
- 有限项截断：只要傅里叶级数被截断（项数有限），对于不连续函数，吉布斯现象就会存在。
- 特定情况 ($N/2$ 项)：
    - 当使用 $N/2$ 个模式（其中 $N$ 是离散点数，例如 $1024$ 个点使用 $512$ 个模式）时，在这些*离散的采样点上*，逼近效果看起来非常好，振铃现象似乎消失了。
    - 这与离散傅里叶变换 (DFT) 和快速傅里叶变换 (FFT) 相关。
- **重要警示**：这种在离散点上消失的现象具有误导性。如果在更高分辨率下观察（即在原始采样点之间进行插值或增加采样点），会发现剧烈的振铃现象依然存在。这只是因为采样点恰好“跳过”了振铃的峰值和谷值。

**六、 吉布斯现象的可视化演变**
- 动态展示：通过动画演示，从 $M=1$ 项增加到 $M=100$ 项时，傅里叶级数逼近方波函数的过程。
- 观察：随着项数 $M$ 的增加：
    - 函数在平坦区域的逼近越来越好。
    - 吉布斯现象的振铃变得更窄，更集中地出现在不连续点的附近。

**七、 与导数计算的潜在联系**
- 展望：未来会讨论使用傅里叶变换来近似计算函数的导数。
- 例子：对连续的三角波函数求导，会得到不连续的方波函数。因此，使用傅里叶方法计算三角波导数的逼近时，也会在其结果（方波逼近）中观察到吉布斯现象。
- 应用：这在求解偏微分方程等领域会遇到。

**八、 总结**
- 理解吉布斯现象对于使用傅里叶级数（或傅里叶变换）处理不连续函数至关重要。
- 在数值应用中需要注意这种由截断引起的潜在振荡伪影。